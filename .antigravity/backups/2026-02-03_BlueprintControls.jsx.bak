import React from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { Layers, Volume2, VolumeX, Terminal } from 'lucide-react';
import { useUI } from '../context/UIContext';

const BlueprintControls = () => {
  const { blueprintMode, toggleBlueprint, soundEnabled, toggleSound, playSound } = useUI();

  return (
    <div className="fixed bottom-32 right-8 flex flex-col gap-4 z-[100]">
      <motion.button
        whileHover={{ scale: 1.1 }}
        whileTap={{ scale: 0.9 }}
        onClick={() => {
            toggleBlueprint();
        }}
        onMouseEnter={() => playSound('hover')}
        className={`w-12 h-12 rounded-full flex items-center justify-center border transition-all duration-500 shadow-xl ${
          blueprintMode 
          ? 'bg-blue-600 border-blue-400 text-white shadow-blue-500/40' 
          : 'bg-white border-neutral-100 text-neutral-500'
        }`}
        title="Toggle Blueprint Mode"
      >
        <Layers size={20} className={blueprintMode ? 'animate-pulse' : ''} />
      </motion.button>

      <motion.button
        whileHover={{ scale: 1.1 }}
        whileTap={{ scale: 0.9 }}
        onClick={() => {
            toggleSound();
            if (!soundEnabled) {
                // Play a test sound when enabling
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                const ctx = new AudioContext();
                const osc = ctx.createOscillator();
                osc.connect(ctx.destination);
                osc.start();
                osc.stop(ctx.currentTime + 0.1);
            }
        }}
        onMouseEnter={() => playSound('hover')}
        className={`w-12 h-12 rounded-full flex items-center justify-center border transition-all duration-500 shadow-xl ${
          soundEnabled 
          ? 'bg-blue-600 border-blue-400 text-white shadow-blue-500/40' 
          : 'bg-white border-neutral-100 text-neutral-500'
        }`}
        title="Toggle Sound Effects"
      >
        {soundEnabled ? <Volume2 size={20} /> : <VolumeX size={20} />}
      </motion.button>

      <AnimatePresence>
        {blueprintMode && (
          <motion.div
            initial={{ opacity: 0, x: 20 }}
            animate={{ opacity: 1, x: 0 }}
            exit={{ opacity: 0, x: 20 }}
            className="absolute right-16 top-0 bg-[#050505] border border-blue-500/30 p-4 rounded-xl shadow-2xl w-64 pointer-events-none"
          >
            <div className="flex items-center gap-2 mb-3 text-blue-500">
                <Terminal size={14} />
                <span className="font-mono text-[10px] font-bold uppercase tracking-widest">System Diagnostics</span>
            </div>
            <div className="space-y-2 font-mono text-[9px] text-blue-400/60">
                <div className="flex justify-between">
                    <span>ENGINE_STATE:</span>
                    <span className="text-blue-400">OPERATIONAL</span>
                </div>
                <div className="flex justify-between">
                    <span>UI_OVERLAY:</span>
                    <span className="text-blue-400">VECTOR_READY</span>
                </div>
                <div className="flex justify-between">
                    <span>AUDIO_SYNTH:</span>
                    <span className="text-blue-400">WEBAUDIO_API</span>
                </div>
                <div className="w-full h-1 bg-blue-900/30 mt-4 rounded-full overflow-hidden">
                    <motion.div 
                        initial={{ width: "0%" }}
                        animate={{ width: "100%" }}
                        transition={{ duration: 2, repeat: Infinity }}
                        className="h-full bg-blue-500" 
                    />
                </div>
            </div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
};

export default BlueprintControls;
